<html>
  <% if(userId==1){%>
    <%- include('../partials/adminHeader') %>
  <%} else{%>
    <%- include('../partials/header') %>
  <%}%>
  
  <head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.rtlcss.com/bootstrap/v4.5.3/css/bootstrap.min.css" integrity="sha384-JvExCACAZcHNJEc7156QaHXTnQL3hQBixvj5RV5buE7vgnNEzzskDtx9NQ4p6BJe" crossorigin="anonymous">

    <!--Css link-->
    <!-- <link href="todoList.css" rel="stylesheet" type="text/css"> -->

  </head>

  <style>

body{
    /* margin-top:20px; */
    color: #1a202c;
    text-align: left;
    background-color: #3b3a3f;    
}
.logo-image{
    width: 150px;
    height: auto;
    /* border-radius: 50%; */
    overflow: hidden;
    margin-top: -6px;
}
a {
    color: #891731;
}
a:hover{
    color:#891731;
}
.inner-wrapper {
    position: relative;
    height: calc(100vh - 3.5rem);
    transition: transform 0.3s;
}
@media (min-width: 992px) {
    .sticky-navbar .inner-wrapper {
        height: calc(100vh - 3.5rem - 48px);
    }
}

.inner-main,
.inner-sidebar {
    position: absolute;
    top: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
}
.inner-sidebar {
    left: 0;
    width: 235px;
    border-right: 1px solid #cbd5e0;
    background-color: #fff;
    z-index: 1;
}
.inner-main {
    right: 0;
    left: 235px;
}
.inner-main-footer,
.inner-main-header,
.inner-sidebar-footer,
.inner-sidebar-header {
    height: 3.5rem;
    border-bottom: 1px solid #cbd5e0;
    display: flex;
    align-items: center;
    padding: 0 1rem;
    flex-shrink: 0;
}
.inner-main-body,
.inner-sidebar-body {
    padding: 1rem;
    overflow-y: auto;
    position: relative;
    flex: 1 1 auto;
}
.inner-main-body .sticky-top,
.inner-sidebar-body .sticky-top {
    z-index: 999;
}
.inner-main-footer,
.inner-main-header {
    background-color: #fff;
}
.inner-main-footer,
.inner-sidebar-footer {
    border-top: 1px solid #cbd5e0;
    border-bottom: 0;
    height: auto;
    min-height: 3.5rem;
}
@media (max-width: 767.98px) {
    .inner-sidebar {
        left: -235px;
    }
    .inner-main {
        left: 0;
    }
    .inner-expand .main-body {
        overflow: hidden;
    }
    .inner-expand .inner-wrapper {
        transform: translate3d(235px, 0, 0);
    }
}

.nav .show>.nav-link.nav-link-faded, .nav-link.nav-link-faded.active, .nav-link.nav-link-faded:active, .nav-pills .nav-link.nav-link-faded.active, .navbar-nav .show>.nav-link.nav-link-faded {
    color: #3367b5;
    background-color: #c9d8f0;
}

.nav-pills .nav-link.active, .nav-pills .show>.nav-link {
    color: #fff;
    background-color: #467bcb;
}
.nav-link.has-icon {
    display: flex;
    align-items: center;
}
.nav-link.active {
    color: #467bcb;
}
.nav-pills .nav-link {
    border-radius: .25rem;
}
.nav-link {
    color: #4a5568;
}
.card {
    box-shadow: 0 1px 3px 0 rgba(0,0,0,.1), 0 1px 2px 0 rgba(0,0,0,.06);
}

.card {
    position: relative;
    display: flex;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 0 solid rgba(0,0,0,.125);
    border-radius: .25rem;
}

.card-body {
    flex: 1 1 auto;
    min-height: 1px;
    padding: 1rem;
}
.btn-primary {
    background-color: #891731;
    border-color: #891731;
}
.btn:not(:disabled):not(.disabled) {
    border-color: #891731;
    background-color: #891731;
}
.bg-primary {
    background-color: #891731 !important;
}
.close {
    float: left;
    color: white;
    margin-right: 0px !important;
}
.btn-light {
    color: white;
  
}
.main-body{
    margin-top: 20px;
}
.form-control-sm{
    line-height:1;
}
.text-body{
    color: #891731 !important;
}
.text-secondary {
    color: black!important;
}
.mr-3.rounded-circle{
    height: 45px;
}
  </style>

<body>
<div class="container">
    <h2 style="color:white; margin-top:40px; text-align:center;">Discuss our tasks</h2>
<div class="main-body p-0">
    <div class="inner-wrapper">
        <!-- Inner sidebar header -->
          <div class="inner-sidebar-header justify-content-center">
            <button class="btn btn-primary has-icon btn-block" type="button" data-toggle="modal" data-target="#threadModal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus mr-2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                NEW DISCUSSION
            </button>
          </div>

            <!-- /Inner main header -->
          <!-- <div class="inner-main"> -->

            <!-- Forum List -->
            <%const revForum=forum.reverse()%>
            <div class="inner-main-body p-2 p-sm-3 collapse forum-content show">
                <% revForum.forEach((frm)=>{%>
                <div class="card mb-2">
                    <div class="card-body p-2 p-sm-3">
                        <div class="media forum-item">
                            <!-- <a href="#" data-toggle="collapse" data-target=".forum-content"> -->
                                <img src="<%= users.find(user=>user.id==frm.userId).imgProfile %>" class="mr-3 rounded-circle" width="50" alt="User" />
                            <!-- </a> -->
                            <div class="media-body">
                                <!-- <h6><a href="#" data-toggle="collapse" data-target=".forum-content" class="text-body"> -->
                                  <h6 class="text-body"><%- frm["title"] %></h6>
                                <!-- </a></h6> -->
                                <p class="text-secondary">
                                    <%- frm["description"] %>
                                </p>
                                <p class="text-muted"><span class="text-secondary font-weight-bold" style="color: #6c757d!important;"><%= users.find(user=>user.id==frm.userId)["userName"]%></span> <span><%= frm["date"] %></span></p>
                                <!-- <iframe src="..\..\controllers\uploadFiles\<%= frm.fileName%>" width="800px" height="2100px"></iframe> -->
                                <a href="http://localhost:3000/task/getFile/<%= frm.fileName%>" target="_blank"><%= frm["fileName"]%></a>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>   
            </div>
            <!-- /Forum List -->        
    </div>

    <!-- New Thread Modal -->
    <div class="modal fade" id="threadModal" tabindex="-1" role="dialog" aria-labelledby="threadModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <form method="POST" action="http://localhost:3000/task/addPostForum"  enctype="multipart/form-data">
                    <div class="modal-header d-flex align-items-center bg-primary text-white">
                        <h6 class="modal-title mb-0" id="threadModalLabel">New Discussion</h6>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">Ã—</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="threadTitle">Title</label>
                            <input type="text" name="threadTitle" class="form-control" id="threadTitle" placeholder="Enter title" autofocus="" />
                        </div>

                        <div class="form-group">
                            <label for="threadDescription">description</label>
                            <textarea name="threadDescription" rows=8 cols=40 wrap=virtual class="form-control" id="threadDescription" placeholder="Enter description"></textarea>
                        </div>


                        <textarea class="form-control summernote" style="display: none;"></textarea>

                        <div hidden="true">        
                            <label for="userId"></label>
                            <input  name="userId" id="userId" />
                       </div>


                        <div class="custom-file form-control-sm mt-3" style="max-width: 300px;">        
                                <label for="threadTitle">Upload file</label>
                                <input type="file" name="myFile" id="myFile" />
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-dismiss="modal">Cancel</button>
                        <button class="btn btn-primary" type="submit" >Post</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</div>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script>
    document.getElementById("userId").value=sessionStorage.getItem("userId");
    console.log("session storage",sessionStorage.getItem("userId"))
</script>
</body>
</html>